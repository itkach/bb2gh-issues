Introduction
============
`comments.py` and `post.py` are two simple scripts to facilitate
migration of issues from `BitBucket`_'s issue tracker to GitHub_. 
BitBucket_ provides an API_ to download issue tracker data, but as of
this writing the data doesn't not include comments. `comments.py`
goes through the issues data returned by the API_, downloads
correspinding HTML pages and extracts comment data. `post.py` reads
issues data output generated by `comments.py` and posts issues to
GitHub_. 

.. _API: http://confluence.atlassian.com/display/BBDEV/Using+the+Bitbucket+REST+APIs

  .. warning::

     These scripts are published in the hope that they may be useful,
     but WITHOUT ANY WARRANTY; without even the implied warranty of
     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. Use at your
     own risk.


Prepare Environment
===================

- Install `virtualenv`_

- Create new virtual environment::

    virtualenv github-migration

- Activate it::

    github-migration/bin/activate

- Install required libraries::

    pip install BeautifulSoup html2text github2

.. _virtualenv: http://pypi.python.org/pypi/virtualenv


Migrating
=========
- Get issue data (replace `username`, `reponame` and `password` with yours)::

    curl https://api.bitbucket.org/1.0/repositories/username/reponame/issues/ -u username:password > issues.json

- Get comments data::

    python comments.py issue.json > issues-with-comments.json

- Post issues to GitHub_ (replace `username` with your GitHub_ user
  name, `api_token` with your secret GitHub_ api token, `reponame` with
  repository name and `user_or_org` with name of the user or
  organization that owns `reponame`)::

    python post.py username api_token user_or_org/reponame issues-with-comments.json

  .. warning::

     Post to a throw-away repository first to make sure you get
     acceptable results

Known Limitations
=================

- Long URLs get wrapped to the next line, edit either before posting
  or on GitHub_ to fix.

- Original author name and create time is added to issue/comment
  content.

- Post breaks down on unicode characters in issue content or comments

.. _BitBucket: http://bitbucket.org
.. _GitHub: http://github.com
